import{r as e,j as a}from"./vendor-react-BqCNLigP.js";import{ao as t,ap as s,aq as r,am as n,a as i}from"./vendor-react-ui-Bu4CYNdA.js";import{L as o}from"./index-KckJq3FG.js";import{g as l,u as c}from"./vendor-router-C4M7CORf.js";import"./vendor-players-DUwgxdJ7.js";import"./vendor-state-9eBMMYdn.js";import"./vendor-firebase-D_MHdhg9.js";const p=()=>{const{id:p}=l(),d=p?decodeURIComponent(p):"",m=c(),[g,h]=e.useState(null),[x,u]=e.useState([]),[w,f]=e.useState(!0),b=new URLSearchParams(window.location.search),v=b.get("source")||"weebcentral",j=b.get("slug")||"",y=async(e,a={})=>{try{const t=new URLSearchParams({source:"weebcentral",action:e,...a}).toString(),s=await fetch(`/api/manga?${t}`);if(!s.ok)throw new Error("WeebCentral request failed");return await s.json()}catch(t){throw t}},N=async(e,a={})=>{try{const t=new URLSearchParams({source:"mangakakalot",action:e,...a}).toString(),s=await fetch(`/api/manga?${t}`);if(!s.ok)throw new Error("Mangakakalot request failed");return await s.json()}catch(t){throw t}},k=async(e,a={})=>{try{const t=new URLSearchParams({source:"manganelo",action:e,...a}).toString(),s=await fetch(`/api/manga?${t}`);if(!s.ok)throw new Error("Manganelo request failed");return await s.json()}catch(t){throw t}},I=async(e,a={})=>{try{const t=new URLSearchParams({source:"mangapanda",action:e,...a}).toString(),s=await fetch(`/api/manga?${t}`);if(!s.ok)throw new Error("MangaPanda request failed");return await s.json()}catch(t){throw t}},$=async(e,a={})=>{try{const t=new URLSearchParams({source:"mangahere",action:e,...a}).toString(),s=await fetch(`/api/manga?${t}`);if(!s.ok)throw new Error("Mangahere request failed");return await s.json()}catch(t){throw t}};e.useEffect(()=>{d&&(async()=>{try{if(f(!0),"mangahere"===v){const e=await $("series",{mangaId:d});if(e?.series){const a=e.series;h({id:d,slug:j,title:a.title||"Unknown Title",description:a.description||"No description available",coverImage:a.coverImage||"https://via.placeholder.com/512x768?text=No+Cover",status:a.status||"unknown",rating:"safe",year:null,author:a.author||"Unknown",artist:a.artist||"Unknown",tags:a.genres||[]})}const a=await $("chapters",{mangaId:d});if(a?.chapters){const e=a.chapters.map((e,a)=>({id:e.id,chapter:e.chapter?String(e.chapter):String(a+1),title:e.title||`Chapter ${a+1}`,pages:0,publishAt:new Date}));u(e)}}else if("weebcentral"===v){const e=await y("series",{seriesId:d});if(e?.series){const a=e.series;h({id:d,slug:j,title:a.title||"Unknown Title",description:a.description||"No description available",coverImage:a.coverImage||"https://via.placeholder.com/512x768?text=No+Cover",status:a.status||"unknown",rating:"safe",year:null,author:"Unknown",artist:"Unknown",tags:[]})}const a=await y("chapters",{seriesId:d});if(a?.chapters){const e=a.chapters.map((e,a)=>({id:e.id,chapter:String(a+1),title:e.title||`Chapter ${a+1}`,pages:0,publishAt:new Date}));u(e)}}else if("mangakakalot"===v){const e=await N("series",{mangaId:d});if(e?.series){const a=e.series;h({id:d,title:a.title||"Unknown Title",description:a.description||"No description available",coverImage:a.coverImage||"https://via.placeholder.com/512x768?text=No+Cover",status:a.status||"unknown",rating:"safe",year:null,author:"Unknown",artist:"Unknown",tags:[]})}const a=await N("chapters",{mangaId:d});if(a?.chapters){const e=a.chapters.map((e,a)=>({id:e.id,chapter:String(a+1),title:e.title||`Chapter ${a+1}`,pages:0,publishAt:new Date}));u(e)}}else if("manganelo"===v){const e=await k("series",{mangaId:d});if(e?.series){const a=e.series;h({id:d,title:a.title||"Unknown Title",description:a.description||"No description available",coverImage:a.coverImage||"https://via.placeholder.com/512x768?text=No+Cover",status:a.status||"unknown",rating:"safe",year:null,author:"Unknown",artist:"Unknown",tags:[]})}const a=await k("chapters",{mangaId:d});if(a?.chapters){const e=a.chapters.map((e,a)=>({id:e.id,chapter:String(a+1),title:e.title||`Chapter ${a+1}`,pages:0,publishAt:new Date}));u(e)}}else if("mangapanda"===v){const e=await I("series",{mangaId:d});if(e?.series){const a=e.series;h({id:d,title:a.title||"Unknown Title",description:a.description||"No description available",coverImage:a.coverImage||"https://via.placeholder.com/512x768?text=No+Cover",status:a.status||"unknown",rating:"safe",year:null,author:"Unknown",artist:"Unknown",tags:[]})}const a=await I("chapters",{mangaId:d});if(a?.chapters){const e=a.chapters.map((e,a)=>({id:e.id,chapter:String(a+1),title:e.title||`Chapter ${a+1}`,pages:0,publishAt:new Date}));u(e)}}}catch(e){h(null)}finally{f(!1)}})()},[d,v,j]);return w?a.jsx("div",{className:"min-h-screen bg-linear-to-br from-gray-900 via-purple-900 to-gray-900 flex items-center justify-center",children:a.jsx(o,{size:"xl"})}):g?a.jsx("div",{className:"min-h-screen bg-linear-to-br from-gray-900 via-purple-900 to-gray-900 text-white",children:a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("button",{onClick:()=>m("/manga"),className:"flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition-colors",children:[a.jsx(t,{}),"Back to Manga"]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"sticky top-8",children:[a.jsx("img",{src:g.coverImage||"https://via.placeholder.com/512x768?text=No+Image",alt:g.title,className:"w-full rounded-xl shadow-2xl",onError:e=>{e.target.src="https://via.placeholder.com/512x768?text=No+Image"}}),a.jsx("div",{className:"mt-4 space-y-2",children:a.jsxs("button",{className:"w-full px-4 py-3 bg-purple-600 hover:bg-purple-700 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",children:[a.jsx(s,{}),"Add to My List"]})})]})}),a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx("h1",{className:"text-4xl font-bold mb-4",children:g.title}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 text-sm",children:[g.year&&a.jsxs("div",{className:"flex items-center gap-2 bg-gray-800/50 px-3 py-1 rounded-full",children:[a.jsx(r,{}),a.jsx("span",{children:g.year})]}),a.jsx("div",{className:"px-3 py-1 rounded-full "+("completed"===g.status?"bg-green-600":"ongoing"===g.status?"bg-blue-600":"bg-gray-600"),children:g.status}),a.jsx("div",{className:"px-3 py-1 rounded-full "+("safe"===g.rating?"bg-green-600":"suggestive"===g.rating?"bg-yellow-600":"bg-red-600"),children:g.rating})]}),a.jsxs("div",{className:"mb-6 text-gray-300",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Author:"})," ",g.author]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"Artist:"})," ",g.artist]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Synopsis"}),a.jsx("p",{className:"text-gray-300 leading-relaxed",children:g.description})]}),g.tags&&g.tags.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-3",children:"Genres"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:g.tags.map((e,t)=>a.jsx("span",{className:"px-3 py-1 bg-purple-600/50 hover:bg-purple-600 rounded-full text-sm transition-colors cursor-pointer",children:e},t))})]})]})]}),a.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6",children:[a.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2 mb-6",children:[a.jsx(n,{className:"text-purple-400"}),"Chapters (",x.length,")"]}),x.length>0&&a.jsx("div",{className:"mb-4 p-4 bg-blue-900/30 border border-blue-500/50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-blue-300",children:[a.jsx("strong",{children:"ðŸ“š Chapter Availability:"})," Free manga chapters from various sources. Some manga may have limited chapters due to licensing or scanlation group policies. All available chapters are shown below."]})}),0===x.length?a.jsxs("div",{className:"text-center py-8 text-gray-400",children:[a.jsx(n,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),a.jsx("p",{className:"mb-2",children:"No chapters available for this manga"}),a.jsx("p",{className:"text-sm text-gray-500",children:"This manga may not have chapters uploaded yet, or they may be exclusively licensed elsewhere."})]}):a.jsx("div",{className:"grid gap-2",children:x.map(e=>a.jsxs("button",{onClick:()=>(e=>{const a=encodeURIComponent(d),t=encodeURIComponent(e);if("weebcentral"===v){const e=j?`&slug=${encodeURIComponent(j)}`:"";m(`/manga/${a}/chapter/${t}?source=weebcentral${e}`)}else if("mangahere"===v){const e=j?`&slug=${encodeURIComponent(j)}`:"";m(`/manga/${a}/chapter/${t}?source=mangahere${e}`)}else m("mangakakalot"===v?`/manga/${a}/chapter/${t}?source=mangakakalot`:"manganelo"===v?`/manga/${a}/chapter/${t}?source=manganelo`:"mangapanda"===v?`/manga/${a}/chapter/${t}?source=mangapanda`:`/manga/${a}/chapter/${t}`)})(e.id),className:"flex items-center justify-between p-4 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-all duration-200 group",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(i,{className:"text-purple-400 group-hover:text-purple-300"}),a.jsxs("div",{className:"text-left",children:[a.jsxs("h3",{className:"font-semibold group-hover:text-purple-400 transition-colors",children:["Chapter ",e.chapter,e.title&&e.title!==`Chapter ${e.chapter}`&&a.jsxs("span",{className:"text-gray-400",children:[" - ",e.title]})]}),e.pages>0&&a.jsxs("p",{className:"text-sm text-gray-400",children:[e.pages," pages"]})]})]}),a.jsx("div",{className:"text-sm text-gray-400",children:e.publishAt.toLocaleDateString()})]},e.id))})]})]})}):a.jsx("div",{className:"min-h-screen bg-linear-to-br from-gray-900 via-purple-900 to-gray-900 flex items-center justify-center text-white",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xl mb-4",children:"Manga not found or failed to load details."}),a.jsx("button",{onClick:()=>m("/manga"),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 rounded-lg font-medium",children:"Back to Manga"})]})})};export{p as MangaDetailPage};
