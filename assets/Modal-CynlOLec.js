const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-DZdVIm41.js","assets/index-Y1OpAnun.js","assets/vendor-react-BqCNLigP.js","assets/vendor-players-DUwgxdJ7.js","assets/vendor-state-9eBMMYdn.js","assets/vendor-react-ui-CyuwbvWU.js","assets/vendor-firebase-D_MHdhg9.js","assets/vendor-router-C4M7CORf.js","assets/index-DRHK9HpR.css"])))=>i.map(i=>d[i]);
import{r as e,j as t}from"./vendor-react-BqCNLigP.js";import{_ as s,u as a,v as l,w as r,x as i,y as n,z as o,A as d,a as c,B as m,C as x,D as u}from"./vendor-react-ui-CyuwbvWU.js";import{r as b,u as p}from"./index-Y1OpAnun.js";import{f as h,P as g}from"./Poster-B5VboZT4.js";import{S as f,A as y,B as v,g as j,E as N}from"./config-BJKyA3im.js";import{u as w,D}from"./useDownloadManager-D6Z9Tom-.js";import"./vendor-players-DUwgxdJ7.js";import"./vendor-state-9eBMMYdn.js";import"./vendor-firebase-D_MHdhg9.js";import"./vendor-router-C4M7CORf.js";const k=b("Share",{web:()=>s(()=>import("./web-DZdVIm41.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(e=>new e.ShareWeb)}),S=({item:s,className:r=""})=>{const{playlists:i,createPlaylist:n,addToPlaylist:o,isInPlaylist:d}=p(),[c,m]=e.useState(!1),[x,u]=e.useState(!1),[b,h]=e.useState("");return t.jsxs("div",{className:`relative ${r}`,children:[t.jsxs("button",{onClick:()=>m(!c),className:"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors font-medium",title:"Add to Playlist",children:[t.jsx(a,{})," Playlist"]}),c&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{m(!1),u(!1)}}),t.jsxs("div",{className:"absolute top-full mt-2 right-0 bg-gray-900 rounded-lg shadow-2xl border border-gray-700 z-50 w-64 max-h-96 overflow-y-auto",children:[x?t.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!b.trim())return;const t=n(b);o(t.id,s),h(""),u(!1),m(!1)},className:"p-4 border-b border-gray-700",children:[t.jsx("input",{type:"text",value:b,onChange:e=>h(e.target.value),placeholder:"Playlist name...",autoFocus:!0,className:"w-full px-3 py-2 bg-gray-800 text-white rounded border border-gray-600 focus:border-purple-500 focus:outline-none mb-2"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded text-sm",children:"Cancel"}),t.jsx("button",{type:"submit",className:"flex-1 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 rounded text-sm",children:"Create"})]})]}):t.jsxs("button",{onClick:()=>u(!0),className:"w-full px-4 py-3 text-left hover:bg-gray-800 flex items-center gap-3 border-b border-gray-700 text-purple-400 font-medium",children:[t.jsx(a,{})," Create New Playlist"]}),0===i.length?t.jsx("div",{className:"px-4 py-6 text-center text-gray-500 text-sm",children:"No playlists yet"}):t.jsx("div",{className:"py-2",children:i.map(e=>{const a=d(e.id,s.id);return t.jsxs("button",{onClick:()=>{return t=e.id,o(t,s),void m(!1);var t},disabled:a,className:"w-full px-4 py-2.5 text-left hover:bg-gray-800 flex items-center justify-between transition-colors "+(a?"opacity-50 cursor-not-allowed":""),children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium text-white truncate",children:e.name}),t.jsxs("div",{className:"text-xs text-gray-400",children:[e.items.length," items"]})]}),a&&t.jsx(l,{className:"text-green-400 shrink-0"})]},e.id)})})]})]})]})},C=({item:s,size:a="medium",showLabel:c=!1})=>{const{isSupported:m,downloads:x,addDownload:u,pauseDownload:b,resumeDownload:p,cancelDownload:h,deleteDownload:g}=w(),[f,y]=e.useState(!1),[v,j]=e.useState("720p"),N=x.find(e=>e.itemId.toString()===s.id.toString()),k=N?.status,S=N?.progress||0;if(!m)return null;const C=(()=>{if(!N)return{icon:i,label:"Download",className:"bg-blue-600 hover:bg-blue-700"};switch(k){case D.QUEUED:return{icon:d,label:"Queued",className:"bg-yellow-600 hover:bg-yellow-700 animate-pulse"};case D.DOWNLOADING:return{icon:o,label:`${Math.round(S)}%`,className:"bg-green-600 hover:bg-green-700"};case D.PAUSED:return{icon:n,label:`${Math.round(S)}%`,className:"bg-orange-600 hover:bg-orange-700"};case D.COMPLETED:return{icon:l,label:"Downloaded",className:"bg-emerald-600 hover:bg-emerald-700"};case D.FAILED:return{icon:r,label:"Failed",className:"bg-red-600 hover:bg-red-700"};case D.CANCELLED:default:return{icon:i,label:"Download",className:"bg-blue-600 hover:bg-blue-700"}}})(),_=C.icon;return t.jsxs("div",{className:"relative inline-block",children:[t.jsxs("button",{onClick:async()=>{N?k===D.DOWNLOADING?await b(N.id):k===D.PAUSED?await p(N.id):k===D.COMPLETED?y(!f):k===D.FAILED&&await p(N.id):y(!f)},className:`download-button flex items-center gap-2 ${C.className} text-white rounded-lg font-medium transition-all duration-300 hover:scale-105 ${{small:"px-2 py-1 text-xs",medium:"px-3 py-2 text-sm",large:"px-4 py-3 text-base"}[a]}`,title:C.label,children:[t.jsx(_,{className:k===D.DOWNLOADING?"animate-spin":""}),c&&t.jsx("span",{children:C.label}),k===D.DOWNLOADING&&t.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-white/30 rounded-b-lg transition-all duration-300",style:{width:`${S}%`}})]}),f&&!N&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>y(!1)}),t.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-lg shadow-xl border border-gray-700 overflow-hidden z-50",children:[t.jsx("div",{className:"p-2 border-b border-gray-700",children:t.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"Select Quality"})}),["360p","480p","720p","1080p"].map(e=>t.jsxs("button",{onClick:()=>(async e=>{j(e),y(!1);try{await u(s,e)}catch(t){alert("Failed to start download. Please check storage space.")}})(e),className:"w-full px-4 py-2 text-left text-white hover:bg-gray-700 transition-colors flex items-center justify-between",children:[t.jsx("span",{children:e}),t.jsxs("span",{className:"text-xs text-gray-400",children:["~","360p"===e?"300MB":"480p"===e?"500MB":"720p"===e?"1GB":"2GB"]})]},e))]})]}),f&&N&&k===D.COMPLETED&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>y(!1)}),t.jsx("div",{className:"absolute right-0 mt-2 w-40 bg-gray-800 rounded-lg shadow-xl border border-gray-700 overflow-hidden z-50",children:t.jsxs("button",{onClick:async()=>{N&&await g(N.id),y(!1)},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-gray-700 transition-colors flex items-center gap-2",children:[t.jsx(r,{}),t.jsx("span",{children:"Delete"})]})})]}),f&&N&&(k===D.DOWNLOADING||k===D.PAUSED)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>y(!1)}),t.jsx("div",{className:"absolute right-0 mt-2 w-40 bg-gray-800 rounded-lg shadow-xl border border-gray-700 overflow-hidden z-50",children:t.jsxs("button",{onClick:async()=>{N&&await h(N.id),y(!1)},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-gray-700 transition-colors flex items-center gap-2",children:[t.jsx(r,{}),t.jsx("span",{children:"Cancel"})]})})]})]})},_=({item:s,onClose:a,isItemInMyList:l,onToggleMyList:r,playOnOpen:i,onEpisodePlay:n,addToWatched:o,isWatched:d,onOpenModal:b,continueWatchingList:p=[]})=>{const[w,D]=e.useState(s),[_,E]=e.useState(null),[P,I]=e.useState([]),[L,O]=e.useState(null),[T,A]=e.useState(1),[M,z]=e.useState(1),[$,F]=e.useState(f?.[0]||null),[W,K]=e.useState(!0),[G,B]=e.useState(!1),U=e.useRef(null);e.useEffect(()=>{K(!0),D(s),O(null),F(f?.[0]||null);const e=s?.media_type||(s?.title?"movie":"tv");Promise.all([h(y.details(e,s.id)),h(y.recommendations(e,s.id))]).then(([t,a])=>{E(t);const l=t?.videos?.results?.find(e=>"Trailer"===e.type&&"YouTube"===e.site);if(O(l||null),I(a?.results||[]),"tv"===e){const e=p.find(e=>e.id?.toString()===s.id?.toString());e?.season&&e?.episode?(A(e.season),z(e.episode)):(A(1),z(1))}B(!!i)}).catch(e=>{}).finally(()=>K(!1)),setTimeout(()=>U.current?.focus(),100)},[s,i]);const Q="tv"===(s?.media_type||(s?.title?"movie":"tv")),q=()=>{B(!0),Q?n?.(w,T,M):n?.(w,1,1),o?.(w?.id)},R=(e,t)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t())},V=async()=>{try{if(!_)return;await k.share({title:_.title||_.name,text:`Check out ${_.title||_.name} on NikzFlix!`,url:window.location.href,dialogTitle:"Share with friends"})}catch(e){}},Y=e=>{A(e),z(1)},H=e=>{z(e),n?.(w,T,e),B(!0),F(f?.[0]||null)},J=e=>F(e),X=e=>{a?.(),setTimeout(()=>b?.(e),300)};if(W||!_)return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-100 flex items-center justify-center",children:t.jsx("div",{className:"player-loading"})});const Z=(()=>{if(!$)return null;const e=f?.[0];if($===e){const e=j(Q?"tv":"movie",w.id,T,M,w.imdb_id,w.mal_id);if(e)return e}const t=N?.[$];return t?Q||"function"!=typeof t.movie?Q&&"function"==typeof t.tv?t.tv(w.id,T,M):null:t.movie(w.id):null})();return t.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-100 flex items-center justify-center p-4",onClick:e=>e.target===e.currentTarget&&a?.(),children:t.jsxs("div",{ref:U,tabIndex:-1,onKeyDown:e=>"Escape"===e.key&&a?.(),className:"modal-content-wrapper focus:outline-none",children:[t.jsx("button",{onClick:a,tabIndex:0,onKeyDown:e=>R(e,a),className:"absolute top-2 right-2 md:-top-4 md:-right-4 text-3xl text-white bg-black/50 rounded-full w-10 h-10 flex items-center justify-center hover:bg-(--brand-color) transition-all z-50 focus:outline-none focus:ring-2 focus:ring-white","aria-label":"Close modal",children:"Ã—"}),t.jsxs("div",{className:"modal-body p-0 sm:p-8 relative overflow-y-auto",children:[G?t.jsxs("div",{className:"aspect-video bg-black rounded-lg",children:[t.jsxs("div",{className:"mb-4 px-8 pt-4 sm:px-0 sm:pt-0",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[t.jsx("span",{className:"font-semibold text-(--text-secondary)",children:"Source:"}),f?.map(e=>t.jsx("button",{onClick:()=>J(e),tabIndex:0,onKeyDown:t=>R(t,()=>J(e)),className:"source-btn px-3 py-1 rounded-full text-sm transition-colors "+($===e?"active bg-(--brand-color) text-white font-bold":"bg-(--bg-tertiary) hover:bg-(--bg-tertiary-hover)"),children:e.replace("_",".")},e))]}),t.jsx("p",{className:"text-xs text-(--text-secondary) opacity-75 italic",children:"ðŸ’¡ Tip: Try a different source if the video doesn't load."})]}),Z?t.jsx("iframe",{src:Z,width:"100%",height:"100%",allowFullScreen:!0,title:"Video Player",className:"rounded-b-lg border-0"}):t.jsx("div",{className:"w-full h-[calc(100%-50px)] flex items-center justify-center text-center text-(--text-secondary) rounded-b-lg",children:t.jsxs("p",{children:["Sorry, the source '",$,"' is not available for this title."]})})]}):t.jsxs("div",{className:"h-64 sm:h-96 bg-cover bg-center rounded-lg relative",style:{backgroundImage:`url(${v}${_.backdrop_path})`},children:[t.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-(--bg-secondary) via-transparent to-transparent"}),t.jsx("button",{onClick:q,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 rounded-full bg-white/30 backdrop-blur-sm text-white flex items-center justify-center text-4xl transition-all duration-300 hover:bg-white/50 hover:scale-110 focus:outline-none focus:ring-4 focus:ring-white/50","aria-label":"Play trailer or video",children:t.jsx(c,{})})]}),t.jsx("div",{className:"mt-6 px-4 pb-4 sm:px-0 sm:pb-0",children:!G&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{className:"text-3xl font-bold",children:_.title||_.name}),t.jsxs("div",{className:"flex items-center space-x-4 my-2 text-sm text-(--text-secondary)",children:[t.jsx("span",{children:_.release_date||_.first_air_date?.split("-")[0]}),t.jsx("span",{children:Q?`${_.number_of_seasons} Season${_.number_of_seasons>1?"s":""}`:_.runtime?`${Math.floor(_.runtime/60)}h ${_.runtime%60}m`:""})]}),t.jsx("p",{className:"text-(--text-primary) mb-4 text-sm sm:text-base",children:_.overview}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 sm:mt-0",children:[!G&&t.jsxs("button",{onClick:q,tabIndex:0,onKeyDown:e=>R(e,q),className:"px-6 py-2 bg-(--brand-color) hover:bg-red-700 rounded font-semibold transition-colors flex items-center gap-2",children:[t.jsx(c,{className:"text-xs"})," Play"]}),t.jsxs("button",{onClick:()=>r?.(w),tabIndex:0,onKeyDown:e=>R(e,()=>r?.(w)),className:"px-6 py-2 bg-(--bg-tertiary) hover:bg-(--bg-tertiary-hover) rounded font-semibold transition-colors flex items-center gap-2",children:[l?.(w?.id)?t.jsx(m,{className:"text-xs"}):t.jsx(x,{className:"text-xs"})," ","My List"]}),t.jsx(S,{item:w}),t.jsx(C,{item:w,quality:"720p",size:"medium",showLabel:!0}),t.jsxs("button",{onClick:V,tabIndex:0,onKeyDown:e=>R(e,V),className:"px-6 py-2 bg-(--bg-tertiary) hover:bg-(--bg-tertiary-hover) rounded font-semibold transition-colors flex items-center gap-2",title:"Share",children:[t.jsx(u,{className:"text-xs"})," Share"]})]}),Q&&t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"section-title",children:"Seasons & Episodes"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:_.seasons?.filter(e=>e.season_number>0).map(e=>t.jsx("button",{onClick:()=>Y(e.season_number),tabIndex:0,onKeyDown:t=>R(t,()=>Y(e.season_number)),className:"px-3 py-1 rounded-full transition-colors font-medium text-sm "+(T===e.season_number?"bg-(--brand-color) text-white":"bg-(--bg-tertiary) hover:bg-(--bg-tertiary-hover)"),children:e.name},e.id))}),t.jsx("div",{className:"episodes grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:Array.from({length:_.seasons?.find(e=>e.season_number===T)?.episode_count||0},(e,t)=>t+1).map(e=>t.jsx("button",{onClick:()=>H(e),tabIndex:0,onKeyDown:t=>R(t,()=>H(e)),className:"aspect-square rounded text-xs sm:text-sm "+(M===e&&G?"active":""),title:`Episode ${e}`,children:e},e))})]})]})}),L&&!G&&t.jsxs("div",{className:"mt-8 px-4 pb-4 sm:px-0 sm:pb-0",children:[t.jsx("h3",{className:"section-title",children:"Trailer"}),t.jsx("div",{className:"aspect-video rounded-lg overflow-hidden",children:t.jsx("iframe",{src:`https://www.youtube.com/embed/${L.key}`,width:"100%",height:"100%",title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}),P.length>0&&t.jsxs("div",{className:"recommendations-section px-4 pb-4 sm:px-0 sm:pb-0",children:[t.jsx("h3",{className:"section-title",children:"More Like This"}),t.jsx("div",{className:"recommendations-grid",children:P.slice(0,10).map(e=>e.poster_path&&t.jsx(g,{item:e,onOpenModal:X,isWatched:d?.(e.id)},e.id))})]})]})]})})};export{_ as Modal,_ as default};
