import{R as t}from"./vendor-react-BqCNLigP.js";import{M as e,C as i}from"./mixin-CWST_Rix.js";import{H as s}from"./vendor-players-DUwgxdJ7.js";const n=(a=e(i),class extends a{static shadowRootOptions={...a.shadowRootOptions};static getTemplateHTML=(t,e={})=>{const{src:i,...s}=t;return`\n        <script type="application/json" id="config">\n          ${JSON.stringify(e.config||{})}\n        <\/script>\n        ${a.getTemplateHTML(s)}\n      `};#t=null;#e=null;constructor(){super(),this.#i("config")}get config(){return this.#e}set config(t){this.#e=t}attributeChangedCallback(t,e,i){"src"!==t&&super.attributeChangedCallback(t,e,i),"src"===t&&e!=i&&this.load()}#s(){var t,e;null==(t=this.#t)||t.remove(),null==(e=this.nativeEl)||e.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#n),this.api&&(this.api.detachMedia(),this.api.destroy(),this.api=null)}async load(){var t,e;const i=!this.api;if(this.#s(),this.src){if(i&&!this.#e&&(this.#e=JSON.parse((null==(t=this.shadowRoot.getElementById("config"))?void 0:t.textContent)||"{}")),s.isSupported()){switch(await Promise.resolve(),this.api=new s({liveDurationInfinity:!0,autoStartLoad:!1,...this.config}),this.api.loadSource(this.src),this.api.attachMedia(this.nativeEl),this.nativeEl.preload){case"none":{const t=()=>this.api.startLoad();this.nativeEl.addEventListener("play",t,{once:!0}),this.api.on(s.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",t)});break}case"metadata":{const t=this.api.config.maxBufferLength,e=this.api.config.maxBufferSize;this.api.config.maxBufferLength=1,this.api.config.maxBufferSize=1;const i=()=>{this.api.config.maxBufferLength=t,this.api.config.maxBufferSize=e};this.nativeEl.addEventListener("play",i,{once:!0}),this.api.on(s.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",i)}),this.api.startLoad();break}default:this.api.startLoad()}this.nativeEl.webkitCurrentPlaybackTargetIsWireless&&this.api.stopLoad(),this.nativeEl.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#n),this.#t=document.createElement("source"),this.#t.setAttribute("type","application/x-mpegURL"),this.#t.setAttribute("src",this.src),this.nativeEl.disableRemotePlayback=!1,this.nativeEl.append(this.#t);const t=new WeakMap;this.api.on(s.Events.MANIFEST_PARSED,(e,i)=>{this.nativeEl.autoplay&&this.nativeEl.paused&&this.nativeEl.play().catch(t=>{}),n();let s=this.videoTracks.getTrackById("main");s||(s=this.addVideoTrack("main"),s.id="main",s.selected=!0);for(const[n,a]of i.levels.entries()){const e=s.addRendition(a.url[0],a.width,a.height,a.videoCodec,a.bitrate);t.set(a,`${n}`),e.id=`${n}`}for(let[t,n]of i.audioTracks.entries()){const e=n.default?"main":"alternative",i=this.addAudioTrack(e,n.name,n.lang);i.id=`${t}`,n.default&&(i.enabled=!0)}}),this.audioTracks.addEventListener("change",()=>{var t;const e=+(null==(t=[...this.audioTracks].find(t=>t.enabled))?void 0:t.id),i=this.api.audioTracks.map(t=>t.id);e!=this.api.audioTrack&&i.includes(e)&&(this.api.audioTrack=e)}),this.api.on(s.Events.LEVELS_UPDATED,(e,i)=>{const s=this.videoTracks[this.videoTracks.selectedIndex??0];if(!s)return;const n=i.levels.map(e=>t.get(e));for(const t of this.videoRenditions)t.id&&!n.includes(t.id)&&s.removeRendition(t)});const i=t=>{const e=t.target.selectedIndex;e!=this.api.nextLevel&&(this.api.nextLevel=e)};null==(e=this.videoRenditions)||e.addEventListener("change",i);const n=()=>{for(const t of this.videoTracks)this.removeVideoTrack(t);for(const t of this.audioTracks)this.removeAudioTrack(t)};return void this.api.once(s.Events.DESTROYING,n)}await Promise.resolve(),this.nativeEl.canPlayType("application/vnd.apple.mpegurl")&&(this.nativeEl.src=this.src)}}#n=()=>{var t,e,i;(null==(t=this.nativeEl)?void 0:t.webkitCurrentPlaybackTargetIsWireless)?null==(e=this.api)||e.stopLoad():null==(i=this.api)||i.startLoad()};#i(t){if(Object.prototype.hasOwnProperty.call(this,t)){const e=this[t];delete this[t],this[t]=e}}});var a;globalThis.customElements&&!globalThis.customElements.get("hls-video")&&globalThis.customElements.define("hls-video",n);var o=n,r=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),l={className:"class",htmlFor:"for"};function c(t){return t.toLowerCase()}function d(t){return"boolean"==typeof t?t?"":void 0:"function"==typeof t||"object"==typeof t&&null!==t?void 0:t}function u(t,e,i){var s;t[e]=i,null==i&&e in((null==(s=globalThis.HTMLElement)?void 0:s.prototype)??{})&&t.removeAttribute(e)}var h=function({react:t,tagName:e,elementClass:i,events:s,displayName:n,defaultProps:a,toAttributeName:o=c,toAttributeValue:h=d}){const p=Number.parseInt(t.version)>=19,f=t.forwardRef((n,c)=>{var f,v;const m=t.useRef(null),g=t.useRef(new Map),E={},y={},T={},L={};for(const[t,e]of Object.entries(n)){if(r.has(t)){T[t]=e;continue}const s=o(l[t]??t);if(i.prototype&&t in i.prototype&&!(t in((null==(f=globalThis.HTMLElement)?void 0:f.prototype)??{}))&&!(null==(v=i.observedAttributes)?void 0:v.some(t=>t===s))){L[t]=e;continue}if(t.startsWith("on")){E[t]=e;continue}const n=h(e);if(s&&null!=n&&(y[s]=String(n),p||(T[s]=n)),s&&p){const t=d(e);T[s]=n!==t?n:e}}if("undefined"!=typeof window){for(const e in E){const i=E[e],n=e.endsWith("Capture"),a=((null==s?void 0:s[e])??e.slice(2).toLowerCase()).slice(0,n?-7:void 0);t.useLayoutEffect(()=>{const t=null==m?void 0:m.current;if(t&&"function"==typeof i)return t.addEventListener(a,i,n),()=>{t.removeEventListener(a,i,n)}},[null==m?void 0:m.current,i])}t.useLayoutEffect(()=>{if(null===m.current)return;const t=new Map;for(const e in L)u(m.current,e,L[e]),g.current.delete(e),t.set(e,L[e]);for(const[e,i]of g.current)u(m.current,e,void 0);g.current=t})}if("undefined"==typeof window&&(null==i?void 0:i.getTemplateHTML)&&(null==i?void 0:i.shadowRootOptions)){const{mode:e,delegatesFocus:s}=i.shadowRootOptions,a=t.createElement("template",{shadowrootmode:e,shadowrootdelegatesfocus:s,dangerouslySetInnerHTML:{__html:i.getTemplateHTML(y,n)}});T.children=[a,T.children]}return t.createElement(e,{...a,...T,ref:t.useCallback(t=>{m.current=t,"function"==typeof c?c(t):null!==c&&(c.current=t)},[c])})});return f.displayName=n??i.name,f}({react:t,tagName:"hls-video",elementClass:o,toAttributeName:t=>"muted"===t?"":"defaultMuted"===t?"muted":c(t)});
/*! Bundled license information:

ce-la-react/dist/ce-la-react.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *
   * Modified version of `@lit/react` for vanilla custom elements with support for SSR.
   *)
*/export{h as default};
