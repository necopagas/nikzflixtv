import{r as e,j as t}from"./vendor-react-BqCNLigP.js";import{f as s,A as n,B as i,u as a,a as r,b as o,c as l,M as d,C as c}from"./index-av1fv5Wb.js";import{u}from"./useRecommendations-CLnTtaMa.js";import{s as m,a as h,m as p}from"./vendor-react-ui-Bu4CYNdA.js";import{G as x}from"./GenreFilter-CrIpEbdF.js";import{R as f}from"./Row-E0LrLkpQ.js";import"./vendor-players-DUwgxdJ7.js";import"./vendor-state-9eBMMYdn.js";import"./vendor-firebase-D_MHdhg9.js";import"./vendor-router-C4M7CORf.js";const g=({onOpenModal:a})=>{const[r,o]=e.useState([]),[l,d]=e.useState(0),[c,u]=e.useState(null),[x,f]=e.useState(!1),g=r[l];e.useEffect(()=>{s(n.trending).then(e=>{const t=(e.results||[]).filter(e=>e.backdrop_path);o(t),d(Math.floor(Math.random()*t.length))})},[]),e.useEffect(()=>{if(r.length>1){const e=setInterval(()=>{d(e=>(e+1)%r.length)},15e3);return()=>clearInterval(e)}},[r]);const b=e.useRef();if(e.useEffect(()=>{if(g){u(null),f(!1);const e=g.media_type||(g.title?"movie":"tv");s(n.details(e,g.id)).then(e=>{const t=e.videos?.results||[];let s=t.find(e=>"Trailer"===e.type&&"YouTube"===e.site);s||(s=t.find(e=>"Teaser"===e.type&&"YouTube"===e.site)),s||(s=t.find(e=>"YouTube"===e.site)),s?(u(s.key),b.current=setTimeout(()=>f(!0),1e3)):u(null)}).catch(e=>{u(null)})}return()=>clearTimeout(b.current)},[g]),!g)return t.jsx("div",{className:"w-full h-[90vh] skeleton"});const v=g.overview.length>200?`${g.overview.substring(0,200)}...`:g.overview;return t.jsxs("div",{className:"banner relative w-full h-[90vh] bg-cover bg-center text-white transition-all duration-1000",style:{backgroundImage:`url(${i}${g.backdrop_path})`},children:[t.jsx("div",{className:"absolute top-0 left-0 w-full h-full z-0 overflow-hidden",onMouseEnter:()=>{clearTimeout(b.current),f(!0)},onMouseLeave:()=>{f(!1)},children:c&&t.jsx(m,{url:`https://www.youtube.com/watch?v=${c}`,playing:!0,muted:!0,loop:!0,width:"100%",height:"100%",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%) scale(1.5)",opacity:x?1:0,transition:"opacity 1s ease-in-out"},config:{youtube:{playerVars:{autoplay:1,controls:0,disablekb:1,showinfo:0,modestbranding:1,fs:0,cc_load_policy:0,iv_load_policy:3,autohide:1}}}})}),t.jsxs("div",{className:"absolute inset-0 z-10 p-4 sm:p-8 md:p-16 flex flex-col justify-center",children:[t.jsx("h1",{className:"banner-title text-4xl md:text-7xl font-extrabold mb-4 max-w-3xl",children:g.title||g.name}),t.jsx("p",{className:"banner-desc text-md md:text-xl mb-8 max-w-md md:max-w-2xl",children:v}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[t.jsxs("button",{onClick:()=>a(g,!0),className:"banner-button bg-gradient-to-r from-[var(--brand-color)] to-red-600 text-white px-8 py-3 rounded-md font-bold shadow-lg hover:shadow-red-500/40 hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2 text-lg",children:[t.jsx(h,{})," Play"]}),t.jsxs("button",{onClick:()=>a(g),className:"banner-button bg-gray-700/70 backdrop-blur-sm text-white px-8 py-3 rounded-md font-bold hover:bg-gray-600/80 hover:scale-105 transition-all duration-300 flex items-center justify-center gap-2 text-lg",children:[t.jsx(p,{})," More Info"]})]})]})]})};function b(){const s=e.useRef(null),n=e.useRef(null),[i,r]=e.useState(!1),[o,l]=e.useState(!1),[d,c]=e.useState("loading"),[u,m]=e.useState(!1),[h,p]=a("nikz_ads_hidden",!1),x="1"===sessionStorage.getItem("nikz_ads_shown");e.useEffect(()=>{h||x?m(!1):(m(!0),sessionStorage.setItem("nikz_ads_shown","1"))},[h,x]);const f="undefined"!=typeof window&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;e.useEffect(()=>{if(h||!u||o||!s.current)return;const e="0b8e16ce5c5d7303bb2755058f2e65b4";let t=null;const n=()=>{if(!s.current)return void c("error");c("loading");if(s.current.querySelector(`script[src*="${e}"]`))return l(!0),void c("loaded");const t=document.createElement("div");t.id=`container-${e}`,s.current.appendChild(t);const n=document.createElement("script");n.async=!0,n.setAttribute("data-cfasync","false"),n.src=`//gainedspotsspun.com/${e}/invoke.js`,n.onload=()=>{l(!0),c("loaded")},n.onerror=()=>{c("error")},s.current.appendChild(n),"undefined"!=typeof window&&(window.__nikz_ads_loaded=[n.src],window.__nikz_ads_timestamp=(new Date).toISOString()),setTimeout(()=>{o||c("error")},2e3)};t=window.setTimeout(n,f?250:500);const i=()=>{window.clearTimeout(t),n(),window.removeEventListener("scroll",i),window.removeEventListener("click",i)};return window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("click",i,{once:!0}),()=>{window.clearTimeout(t),window.removeEventListener("scroll",i),window.removeEventListener("click",i)}},[h,u,o,f]),e.useEffect(()=>{n.current&&(n.current.dataset.ready=u&&!h?"1":"0")},[u,h]);return h||!u||"loading"===d?null:t.jsx("div",{ref:n,className:"fixed inset-x-4 sm:inset-x-auto sm:left-1/2 sm:-translate-x-1/2 bottom-[env(safe-area-inset-bottom,1.5rem)] pointer-events-none",style:{zIndex:9999},"aria-live":"polite","data-banner-ready":"true",children:t.jsxs("div",{className:`\n          pointer-events-auto backdrop-blur-md rounded-xl shadow-2xl\n          border border-gray-700/50\n          transition-all duration-500 ease-out\n          ${i?"opacity-50 scale-95":"opacity-100 scale-100"}\n        `,style:{minWidth:320,maxWidth:"90vw",margin:"0 auto",background:"linear-gradient(225deg, rgba(15,23,42,0.95), rgba(15,23,42,0.6))",transform:i?"translateY(20%) scale(0.95)":"translateY(0) scale(1)"},children:[t.jsxs("div",{className:"flex items-start gap-3 p-3",children:[t.jsxs("div",{ref:s,className:"flex-1 flex items-center justify-center min-h-[90px] relative",id:"nikz-ad-container",children:["error"===d&&t.jsxs("div",{className:"flex flex-col items-center gap-2 py-4 text-center",children:[t.jsx("span",{className:"text-xs text-orange-400",children:"âš ï¸ Ad could not be loaded"}),t.jsxs("span",{className:"text-[10px] text-gray-500",children:["Ads are currently unavailable. Please try again later.",t.jsx("br",{}),"If you are the site owner, check your Adsterra dashboard."]})]}),"loaded"===d&&!s.current?.querySelector("script")&&t.jsx("div",{className:"text-xs text-gray-400 py-4",children:"ğŸ“º Ad space ready - waiting for impressions"})]}),t.jsxs("div",{className:"flex flex-col gap-1.5 pt-1",children:[t.jsx("button",{onClick:()=>r(!i),className:"\n                w-8 h-8 flex items-center justify-center\n                bg-gray-700/50 hover:bg-gray-600/70\n                text-gray-300 hover:text-white\n                rounded-lg transition-all duration-200\n                hover:scale-110 active:scale-95\n              ",title:i?"Expand":"Collapse","aria-label":i?"Expand ads":"Collapse ads",children:t.jsx("span",{className:"text-sm font-bold",children:i?"â–¸":"â–¾"})}),t.jsx("button",{onClick:()=>{p(!0),m(!1)},className:"\n                w-8 h-8 flex items-center justify-center\n                bg-red-600/80 hover:bg-red-600\n                text-white\n                rounded-lg transition-all duration-200\n                hover:scale-110 active:scale-95\n              ",title:"Hide ads permanently","aria-label":"Dismiss ads",children:t.jsx("span",{className:"text-sm font-bold",children:"âœ•"})})]})]}),!1]})})}const v=({onOpenModal:i,isWatched:a})=>{const{myList:m,loading:h}=r(),{continueWatchingList:p,loading:v}=o(),{watchedHistory:w,loading:y}=l(),{recommendations:j,loading:M,sourceItem:S,hasWatchHistory:k,hasMyList:W}=u(),[O,L]=e.useState([]),[N,_]=e.useState([]),[E,T]=e.useState([]),[Y,$]=e.useState([]),[P,A]=e.useState([]),[C,F]=e.useState([]),[I,R]=e.useState(null),[z,G]=e.useState([]),[H,B]=e.useState(!1),[D,q]=e.useState([]),[V,J]=e.useState(null),[K,Q]=e.useState(!1),U=e.useRef(null),X=e.useRef(!1),[Z,ee]=e.useState([]),[te,se]=e.useState(!0);e.useEffect(()=>{let e=!0;return(async()=>{const[t,i,a,r,o,l]=await Promise.all([s(n.trending),s(n.popular),s(n.toprated),s(n.tvshows),s(n.anime),s(n.asianDramas)]);e&&(L(t.results||[]),_(i.results||[]),T(a.results||[]),$(r.results||[]),A(o.results||[]),F(l.results||[]))})(),()=>{e=!1}},[]),e.useEffect(()=>{let e=!0;return(async()=>{if(y)return;if(0===w.length)return e&&(Q(!1),q([]),J(null)),U.current=null,void(X.current=!1);const t=w[w.length-1],i=t?.toString();if(U.current!==i||X.current){U.current=i,X.current=!0,e&&(Q(!0),q([]),J(null));try{const[t,a]=await Promise.all([s(n.details("movie",i)).catch(()=>null),s(n.details("tv",i)).catch(()=>null)]),r=t?.id?t:a?.id?a:null,o=t?.id?"movie":"tv";if(!r)return U.current=null,void(e&&(q([]),Q(!1)));e&&J(r);const l=await s(n.recommendations(o,i));e&&q(l.results||[])}catch(a){U.current=null}finally{X.current=!1,e&&Q(!1)}}})(),()=>{e=!1}},[w,y]),e.useEffect(()=>{let e=!0;return(async()=>{e&&se(!0);const t=c.map(async e=>{if(e.endpoint)try{const t=await s(e.endpoint),n=(t?.results||[]).filter(e=>e&&e.poster_path),i=e.limit?n.slice(0,e.limit):n;return{title:e.title,items:i}}catch(t){return{title:e.title,items:[]}}if(Array.isArray(e.ids)&&e.ids.length){const t=e.ids.map(e=>s(n.details(e.type,e.id)).catch(e=>null)),i=(await Promise.all(t)).filter(e=>e&&(e.poster_path||e.backdrop_path));return{title:e.title,items:i}}return{title:e.title,items:[]}}),i=await Promise.all(t);e&&(ee(i.filter(e=>e.items.length>0)),se(!1))})(),()=>{e=!1}},[]);const ne=e=>Z.find(t=>t.title===e);return t.jsxs(t.Fragment,{children:[t.jsx(g,{onOpenModal:i}),t.jsx("div",{className:"bg-[#0b0b0b] text-white min-h-screen",children:t.jsx("div",{className:"px-4 sm:px-8 md:px-16 pb-20",children:t.jsx("div",{children:t.jsxs("main",{children:[t.jsx(x,{genres:d,selectedGenre:I,onGenreSelect:e=>{I===e?(R(null),G([])):(R(e),B(!0),s(n.byGenre(e)).then(e=>G(e.results||[])).finally(()=>B(!1)))}}),I&&t.jsx(f,{id:`genre-${I}`,title:d.find(e=>e.id===I)?.name||"Genre Results",items:z,onOpenModal:i,isWatched:a,isLoading:H},`genre-${I}`),!te&&t.jsxs(t.Fragment,{children:[(()=>{const e=ne("Halloween Horrors");return e?t.jsx(f,{id:"halloween-horrors",title:"ğŸƒ Halloween Horrors",items:e.items,onOpenModal:i,isWatched:a}):null})(),(()=>{const e=ne("Mind-Bending Sci-Fi");return e?t.jsx(f,{id:"mind-bending-sci-fi",title:"ğŸ§ ğŸš€ Mind-Bending Sciâ€‘Fi",items:e.items,onOpenModal:i,isWatched:a}):null})(),(()=>{const e=ne("Editor Picks");return e?t.jsx(f,{id:"editor-picks",title:"âœï¸â­ Editor Picks",items:e.items,onOpenModal:i,isWatched:a}):null})()]}),te&&t.jsxs(t.Fragment,{children:[t.jsx(f,{id:"halloween-horrors",title:"ğŸƒ Halloween Horrors",items:[],onOpenModal:i,isWatched:a,isLoading:!0}),t.jsx(f,{id:"mind-bending-sci-fi",title:"ğŸ§ ğŸš€ Mind-Bending Sciâ€‘Fi",items:[],onOpenModal:i,isWatched:a,isLoading:!0}),t.jsx(f,{id:"editor-picks",title:"âœï¸â­ Editor Picks",items:[],onOpenModal:i,isWatched:a,isLoading:!0})]}),(D.length>0||K)&&V&&t.jsx(f,{id:"because-you-watched",title:`ğŸ‘€ ${(()=>{if(!V)return"";const e=V.title||V.name;return`Because You Watched ${e.length>30?`${e.substring(0,30)}...`:e}`})()}`,items:D,onOpenModal:i,isWatched:a,isLoading:K}),k&&j.becauseYouWatched.length>0&&t.jsx(f,{id:"ai-because-you-watched",title:`ğŸ¯ ${(()=>{if(!S)return"Because You Watched";const e=S.title||S.name;return`Because You Watched ${e.length>30?`${e.substring(0,30)}...`:e}`})()}`,items:j.becauseYouWatched,onOpenModal:i,isWatched:a,isLoading:M}),k&&j.basedOnGenres.length>0&&t.jsx(f,{id:"ai-based-on-genres",title:"ğŸ¨ Based On Your Favorite Genres",items:j.basedOnGenres,onOpenModal:i,isWatched:a,isLoading:M}),j.forYou.length>0&&t.jsx(f,{id:"ai-for-you",title:"âœ¨ Picked For You",items:j.forYou,onOpenModal:i,isWatched:a,isLoading:M}),W&&j.similar.length>0&&t.jsx(f,{id:"ai-similar-to-list",title:"ğŸ’« More Like Your List",items:j.similar,onOpenModal:i,isWatched:a,isLoading:M}),j.trending.length>0&&t.jsx(f,{id:"ai-trending-for-you",title:"ğŸ“ˆ Trending For You",items:j.trending,onOpenModal:i,isWatched:a,isLoading:M})," ",t.jsx(f,{id:"trending-now",title:"ğŸ”¥ Trending Now",items:O,onOpenModal:i,isWatched:a}),t.jsx(f,{id:"popular-movies",title:"ğŸ¿ Popular Movies",items:N,onOpenModal:i,isWatched:a}),(p.length>0||v)&&t.jsx(f,{id:"continue-watching",title:"â–¶ï¸ Continue Watching",items:p,onOpenModal:i,isWatched:a,isLoading:v}),t.jsx(f,{id:"top-rated",title:"ğŸ† Top Rated Movies",items:E,onOpenModal:i,isWatched:a}),t.jsx(f,{id:"popular-tv",title:"ğŸ“º Popular TV Shows",items:Y,onOpenModal:i,isWatched:a}),(m.length>0||h)&&t.jsx(f,{id:"my-list",title:"â­ My List",items:m,onOpenModal:i,isWatched:a,isLoading:h}),t.jsx(f,{id:"anime",title:"ğŸ‰ Anime",items:P,onOpenModal:i,isWatched:a,isLarge:!0}),t.jsx(f,{id:"asian-dramas",title:"ğŸ­ Asian Dramas",items:C,onOpenModal:i,isWatched:a}),t.jsx(b,{})]})})})})]})};export{v as HomePage};
