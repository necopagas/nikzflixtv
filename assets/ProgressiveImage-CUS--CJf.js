import{r as e,j as t}from"./vendor-react-BqCNLigP.js";var r=new Map,n=new WeakMap,s=0;function i(e){return Object.keys(e).sort().filter(t=>void 0!==e[t]).map(t=>{return`${t}_${"root"===t?(r=e.root,r?(n.has(r)||(s+=1,n.set(r,s.toString())),n.get(r)):"0"):e[t]}`;var r}).toString()}function a(e,t,n={},s=undefined){if(void 0===window.IntersectionObserver&&void 0!==s){const r=e.getBoundingClientRect();return t(s,{isIntersecting:s,target:e,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),()=>{}}const{id:a,observer:o,elements:l}=function(e){const t=i(e);let n=r.get(t);if(!n){const s=new Map;let i;const a=new IntersectionObserver(t=>{t.forEach(t=>{var r;const n=t.isIntersecting&&i.some(e=>t.intersectionRatio>=e);e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=n),null==(r=s.get(t.target))||r.forEach(e=>{e(n,t)})})},e);i=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:a,elements:s},r.set(t,n)}return n}(n),c=l.get(e)||[];return l.has(e)||l.set(e,c),c.push(t),o.observe(e),function(){c.splice(c.indexOf(t),1),0===c.length&&(l.delete(e),o.unobserve(e)),0===l.size&&(o.disconnect(),r.delete(a))}}const o=({src:r,alt:n="",className:s="",placeholderSrc:i=null,onLoad:o=null,onError:l=null,fallbackSrc:c="/placeholder.png",threshold:d=.01,rootMargin:h="50px"})=>{const[u,p]=e.useState(i||c),[m,g]=e.useState(!0),[f,b]=e.useState(!1),x=e.useRef(null),{ref:v,inView:y}=function({threshold:t,delay:r,trackVisibility:n,rootMargin:s,root:i,triggerOnce:o,skip:l,initialInView:c,fallbackInView:d,onChange:h}={}){var u;const[p,m]=e.useState(null),g=e.useRef(h),[f,b]=e.useState({inView:!!c,entry:void 0});g.current=h,e.useEffect(()=>{if(l||!p)return;let e;return e=a(p,(t,r)=>{b({inView:t,entry:r}),g.current&&g.current(t,r),r.isIntersecting&&o&&e&&(e(),e=void 0)},{root:i,rootMargin:s,threshold:t,trackVisibility:n,delay:r},d),()=>{e&&e()}},[Array.isArray(t)?t.toString():t,p,i,s,o,l,n,d,r]);const x=null==(u=f.entry)?void 0:u.target,v=e.useRef(void 0);p||!x||o||l||v.current===x||(v.current=x,b({inView:!!c,entry:void 0}));const y=[m,f.inView,f.entry];return y.ref=y[0],y.inView=y[1],y.entry=y[2],y}({threshold:d,rootMargin:h,triggerOnce:!0});return e.useEffect(()=>{if(!y)return;const e=new Image;return e.onload=()=>{p(r),g(!1),o&&o()},e.onerror=()=>{p(c),g(!1),b(!0),l&&l()},e.src=r,()=>{e.onload=null,e.onerror=null}},[y,r,c,o,l]),t.jsxs("div",{ref:v,className:"relative overflow-hidden",children:[t.jsx("img",{ref:x,src:u,alt:n,className:`${s} transition-all duration-500 ease-in-out ${m?"blur-sm scale-105 opacity-50":"blur-0 scale-100 opacity-100"} ${f?"opacity-50":""}`,loading:"lazy"}),m&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-800/50",children:t.jsx("div",{className:"w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"})})]})},l=({width:e="100%",height:r="200px",borderRadius:n="8px",className:s=""})=>t.jsx("div",{className:`bg-linear-to-r from-gray-800 via-gray-700 to-gray-800 animate-pulse ${s}`,style:{width:e,height:r,borderRadius:n},children:t.jsx("div",{className:"w-full h-full bg-linear-to-r from-transparent via-white/10 to-transparent animate-shimmer"})}),c=({count:e=1,className:r=""})=>t.jsx(t.Fragment,{children:Array.from({length:e}).map((e,n)=>t.jsxs("div",{className:`space-y-2 ${r}`,children:[t.jsx(l,{height:"300px",borderRadius:"12px"}),t.jsx(l,{height:"20px",width:"80%",borderRadius:"4px"}),t.jsx(l,{height:"16px",width:"60%",borderRadius:"4px"})]},n))}),d=({item:e,onClick:r,isWatched:n,isLarge:s=!1,showTitle:i=!0})=>{const a=e.backdrop_path||e.poster_path?`https://image.tmdb.org/t/p/${s?"w500":"w300"}${e.backdrop_path||e.poster_path}`:"/placeholder.png",l=e.backdrop_path||e.poster_path?`https://image.tmdb.org/t/p/w92${e.backdrop_path||e.poster_path}`:"/placeholder.png";return t.jsxs("div",{className:"relative cursor-pointer group transform transition-all duration-300 hover:scale-105 hover:z-10",onClick:()=>r&&r(e),children:[t.jsx(o,{src:a,placeholderSrc:l,alt:e.title||e.name||"Poster",className:"w-full h-auto rounded-lg shadow-lg",fallbackSrc:"/placeholder.png"}),n&&n(e.id)&&t.jsx("div",{className:"absolute top-2 right-2 bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold",children:"✓ Watched"}),i&&t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-3 rounded-b-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[t.jsx("h3",{className:"text-white font-semibold text-sm line-clamp-2",children:e.title||e.name}),e.vote_average&&t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx("span",{className:"text-yellow-400",children:"★"}),t.jsx("span",{className:"text-white text-xs",children:e.vote_average.toFixed(1)})]})]})]})};"undefined"!=typeof window&&(()=>{if("undefined"!=typeof document&&!document.getElementById("shimmer-styles")){const e=document.createElement("style");e.id="shimmer-styles",e.textContent="\n      @keyframes shimmer {\n        0% { transform: translateX(-100%); }\n        100% { transform: translateX(100%); }\n      }\n      .animate-shimmer {\n        animation: shimmer 2s infinite;\n      }\n    ",document.head.appendChild(e)}})();export{d as O,c as P};
